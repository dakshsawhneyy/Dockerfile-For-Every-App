FROM mcr.microsoft.com/dotnet/sdk:9.0 AS build

WORKDIR /app

#  C# project definition file
COPY cartservice.csproj ./
# Reads the .csproj file, downloads all required NuGet dependencies
RUN dotnet restore

COPY . .
# dotnet publish â€” Compiles the app and prepares it for deployment.|| -c Release means use the Release build configuration || -o /app/publish means output the compiled files into /app/publish
RUN dotnet publish -c Release -o /app/publish

FROM mcr.microsoft.com/dotnet/aspnet:9.0 AS runtime

WORKDIR /app

COPY --from=build /app/publish ./

EXPOSE 7070

ENTRYPOINT ["dotnet", "cartservice.dll"]
